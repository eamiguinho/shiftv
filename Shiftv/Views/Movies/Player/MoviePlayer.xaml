<Page
    x:Class="Shiftv.Views.Movies.Player.MoviePlayer"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:playerFramework="using:Microsoft.PlayerFramework"
    xmlns:webVtt="using:Microsoft.PlayerFramework.WebVTT"
    xmlns:captionSettings="using:Microsoft.PlayerFramework.WebVTT.CaptionSettings"
    xmlns:player="using:Shiftv.ViewModels.Movies.Player"
    xmlns:handlers="using:Shiftv.Views.Handlers"
    xmlns:appBar="using:Shiftv.Views.AppBar"
    xmlns:interactivity="using:Microsoft.Xaml.Interactivity"
    xmlns:core="using:Microsoft.Xaml.Interactions.Core"
    xmlns:controls="using:Callisto.Controls"
    mc:Ignorable="d" x:Name="PageRoot" SizeChanged="pageRoot_SizeChanged">

    <Page.DataContext>
        <player:MoviePlayerViewModel />
    </Page.DataContext>
    <Page.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="ms-appx:///Common/Styles.xaml" />
            </ResourceDictionary.MergedDictionaries>
        </ResourceDictionary>
    </Page.Resources>

    <Grid Background="{ThemeResource ApplicationPageBackgroundThemeBrush}">
        <Grid.ChildrenTransitions>
            <TransitionCollection>
                <EntranceThemeTransition/>
            </TransitionCollection>
        </Grid.ChildrenTransitions>
        <Grid Margin="0 0 0 0">
            <Grid.RowDefinitions>
                <RowDefinition Height="140"></RowDefinition>
                <RowDefinition Height="*"></RowDefinition>
            </Grid.RowDefinitions>

            <Grid x:Name="Header" Grid.Row="0" Margin="60 0 0 0">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="80"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                <Grid Background="{StaticResource ShiftvDarkGreen}" Width="80" Height="70">
                    <Button Margin="15,-1,10,0" Command="{Binding NavigationHelper.GoBackCommand, ElementName=PageRoot}"
                        Style="{StaticResource NavigationBackButtonNormalStyle}"
                        VerticalAlignment="Center"
                        AutomationProperties.Name="Back"
                        AutomationProperties.AutomationId="BackButton"
                        AutomationProperties.ItemType="Navigation Button" HorizontalAlignment="Left"/>
                </Grid>

                <TextBlock Margin="15" Text="{Binding Movie.Title}" Style="{StaticResource HeaderTextBlockStyle}" Grid.Column="1" 
                        IsHitTestVisible="false" TextWrapping="NoWrap" VerticalAlignment="Center"/>
            </Grid>


            <ScrollViewer ZoomMode="Disabled" x:Name="Scroll" Grid.Column="0"  VerticalScrollMode="Disabled" Grid.Row="1" HorizontalScrollMode="Auto" HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Disabled">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"></ColumnDefinition>
                        <ColumnDefinition Width="Auto"></ColumnDefinition>
                        <ColumnDefinition Width="Auto"></ColumnDefinition>
                        <ColumnDefinition Width="Auto"></ColumnDefinition>
                    </Grid.ColumnDefinitions>
                    <Grid Grid.Column="0" Margin="60 0 40 0" Width="600">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"></RowDefinition>
                            <RowDefinition Height="40"></RowDefinition>
                            <RowDefinition Height="1*"></RowDefinition>
                        </Grid.RowDefinitions>
                        <Grid Visibility="{Binding IsLoadingLinks, Converter={StaticResource BooleanToVisibility}}" HorizontalAlignment="Center" VerticalAlignment="Top" Margin="0 40 0 0">
                            <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                                <ProgressRing IsActive="True" Width="40" Height="40" HorizontalAlignment="Center" Foreground="White"></ProgressRing>
                                <TextBlock Margin="0 10 0 0"  Style="{StaticResource SubheaderTextBlockStyle}" Text="{Binding [CrawlingMessage], Source={StaticResource Localized}}" HorizontalAlignment="Center"></TextBlock>
                            </StackPanel>
                        </Grid>
                        <Grid Grid.Row="0"
                              Visibility="{Binding NoLinksAvailable, Converter={StaticResource BooleanToVisibility}}" HorizontalAlignment="Center" VerticalAlignment="Top"  Margin="0 40 0 0">
                            <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                                <Image Style="{StaticResource RedSadSmileImage}" ></Image>
                                <TextBlock Style="{StaticResource SubheaderTextBlockStyle}" Text="{Binding [CrawlingNotFound], Source={StaticResource Localized}}" HorizontalAlignment="Center"></TextBlock>
                            </StackPanel>
                        </Grid>
                        <Grid Grid.Row="0" x:Name="PubGrid" Visibility="Visible" Margin="0 150 0 0">
                            <StackPanel Orientation="Vertical" Margin="20 0 20 0" HorizontalAlignment="Center" VerticalAlignment="Center">
                                <Button FontWeight="Light" FontSize="22" Height="55" BorderThickness="0"
                                    Background="#00a000" Foreground="White"
                                    FontFamily="Segoe UI" HorizontalAlignment="Left" Click="ReviewClicked">
                                    <ContentControl >
                                        <StackPanel Orientation="Horizontal">

                                            <Path Data="F1M181.003,-1898.78L207.077,-1902.33 207.089,-1877.18 181.027,-1877.03 181.003,-1898.78z M207.065,-1874.28L207.085,-1849.1 181.023,-1852.69 181.022,-1874.45 207.065,-1874.28z M210.226,-1902.79L244.798,-1907.84 244.798,-1877.5 210.226,-1877.22 210.226,-1902.79z M244.807,-1874.04L244.798,-1843.84 210.226,-1848.72 210.177,-1874.1 244.807,-1874.04z" Stretch="Uniform" Fill="#FFFFFFFF" Width="30" Height="30" Margin="0,0,0,0" RenderTransformOrigin="0.5,0.5">
                                                <Path.RenderTransform>
                                                    <TransformGroup>
                                                        <TransformGroup.Children>
                                                            <RotateTransform Angle="0" />
                                                            <ScaleTransform ScaleX="1" ScaleY="1" />
                                                        </TransformGroup.Children>
                                                    </TransformGroup>
                                                </Path.RenderTransform>
                                            </Path>
                                            <TextBlock Text="{Binding [ReviewStore],Source={StaticResource Localized}}" Margin="20 -2 0 0" FontWeight="Thin" FontSize="26"></TextBlock>
                                        </StackPanel>
                                    </ContentControl>
                                </Button>
                                <Button FontWeight="Light" FontSize="22" Height="55" BorderThickness="0"
                                    Background="#3b5998" Foreground="White"
                                    FontFamily="Segoe UI" HorizontalAlignment="Left" Click="FacebookClick">
                                    <ContentControl >
                                        <StackPanel Orientation="Horizontal">

                                            <Path Data="F1M-1775.32,-68.9708L-1831.47,-68.9708C-1833.27,-68.9708,-1834.73,-67.3745,-1834.73,-65.4058L-1834.73,-10.1649C-1834.73,-8.19482,-1833.27,-6.59973,-1831.47,-6.59973L-1802.47,-6.59973 -1802.47,-32.2261 -1809.5,-32.2261 -1809.5,-40.5503 -1802.47,-40.5503 -1802.47,-45.5282C-1802.47,-50.9435,-1798.08,-55.3315,-1792.66,-55.3315L-1783.74,-55.3315 -1783.74,-47.0099 -1787.86,-47.0099C-1789.89,-47.0099,-1791.53,-45.3667,-1791.53,-43.3407L-1791.53,-40.5503 -1783.74,-40.5503 -1783.74,-32.2261 -1791.53,-32.2261 -1791.53,-6.59973 -1775.32,-6.59973C-1773.52,-6.59973,-1772.06,-8.19482,-1772.06,-10.1649L-1772.06,-65.4058C-1772.06,-67.3745,-1773.52,-68.9708,-1775.32,-68.9708" Stretch="Uniform" Fill="#FFFFFFFF" Width="30" Height="30" Margin="0,0,0,0" RenderTransformOrigin="0.5,0.5">
                                                <Path.RenderTransform>
                                                    <TransformGroup>
                                                        <TransformGroup.Children>
                                                            <RotateTransform Angle="0" />
                                                            <ScaleTransform ScaleX="1" ScaleY="1" />
                                                        </TransformGroup.Children>
                                                    </TransformGroup>
                                                </Path.RenderTransform>
                                            </Path>
                                            <TextBlock Text="{Binding [ReviewFacebook],Source={StaticResource Localized}}" Margin="20 -2 0 0" FontWeight="Thin" FontSize="26"></TextBlock>
                                        </StackPanel>
                                    </ContentControl>
                                </Button>
                                <Button FontWeight="Light" FontSize="22" Height="55" BorderThickness="0"
                                    Background="#5ea9dd" Foreground="White"
                                    FontFamily="Segoe UI" HorizontalAlignment="Left" Click="TwitterClicked">
                                    <ContentControl >
                                        <StackPanel Orientation="Horizontal">

                                            <Path Data="F1M442.233,523.977C439.879,525.023 437.348,525.727 434.691,526.045 437.402,524.42 439.484,521.847 440.465,518.781 437.928,520.286 435.117,521.378 432.126,521.967 429.732,519.415 426.319,517.821 422.543,517.821 415.292,517.821 409.413,523.7 409.413,530.951 409.413,531.98 409.529,532.982 409.753,533.943 398.84,533.395 389.164,528.169 382.689,520.225 381.559,522.163 380.911,524.419 380.911,526.825 380.911,531.381 383.229,535.399 386.753,537.755 384.6,537.686 382.575,537.096 380.805,536.113 380.803,536.167 380.803,536.222 380.803,536.277 380.803,542.639 385.329,547.946 391.336,549.152 390.234,549.452 389.074,549.613 387.878,549.613 387.031,549.613 386.208,549.531 385.406,549.377 387.077,554.593 391.927,558.39 397.672,558.496 393.178,562.018 387.517,564.117 381.366,564.117 380.306,564.117 379.26,564.054 378.233,563.933 384.044,567.658 390.945,569.833 398.361,569.833 422.512,569.833 435.719,549.825 435.719,532.473 435.719,531.904 435.707,531.338 435.681,530.774 438.247,528.924 440.473,526.611 442.233,523.977z" Stretch="Uniform" Fill="#FFFFFFFF" Width="30" Height="30" Margin="0,0,0,0" RenderTransformOrigin="0.5,0.5">
                                                <Path.RenderTransform>
                                                    <TransformGroup>
                                                        <TransformGroup.Children>
                                                            <RotateTransform Angle="0" />
                                                            <ScaleTransform ScaleX="1" ScaleY="1" />
                                                        </TransformGroup.Children>
                                                    </TransformGroup>
                                                </Path.RenderTransform>
                                            </Path>
                                            <TextBlock Text="{Binding [ReviewTwitter],Source={StaticResource Localized}}" Margin="20 -2 0 0" FontWeight="Thin" FontSize="26"></TextBlock>
                                        </StackPanel>
                                    </ContentControl>
                                </Button>
                                <Button FontWeight="Light" FontSize="15" Height="45" x:Name="RestartButton"  Visibility="Collapsed"
                                    BorderThickness="0"
                                    Background="#dfdfdf" Foreground="{StaticResource ShiftvDarkGreen}"
                                    FontFamily="Segoe UI" HorizontalAlignment="Left" Click="PlayAgain">
                                    <ContentControl >
                                        <StackPanel Orientation="Vertical">
                                            <TextBlock Text="Play this movie again"  FontWeight="Thin" FontSize="18"></TextBlock>
                                            <!--<TextBlock Text="a "  FontWeight="Thin" FontSize="18"></TextBlock>-->
                                        </StackPanel>
                                    </ContentControl>
                                </Button>

                            </StackPanel>
                        </Grid>
                        <Canvas Grid.Row="0" x:Name="PlayerCanvas" Width="600" Height="400" SizeChanged="playerCanvas_SizeChanged" HorizontalAlignment="Left" VerticalAlignment="Top">
                            <Canvas.RenderTransform>
                                <TranslateTransform x:Name="CanvasMover"/>
                            </Canvas.RenderTransform>
                            <playerFramework:MediaPlayer IsCaptionSelectionVisible="True" IsCaptionsActive="True" IsCaptionSelectionEnabled="{Binding CanChooseSubtitles}" Width="500" Height="300" AutoPlay="False" IsFullScreenVisible="True" x:Name="Player" DoubleTapped="Player_OnTapped" CurrentStateChanged="Player_OnCurrentStateChanged" MediaOpened="Player_OnMediaOpened">
                                <playerFramework:MediaPlayer.Plugins>
                                    <webVtt:WebVTTPlugin/>
                                    <captionSettings:WebVTTCaptionSettingsPlugin/>
                                </playerFramework:MediaPlayer.Plugins>

                            </playerFramework:MediaPlayer>
                        </Canvas>
                        <StackPanel x:Name="LoadingSubs" Orientation="Horizontal" Margin="0 5 0 0"  Grid.Row="1" Visibility="{Binding IsLoadingSubtitles, Converter={StaticResource BooleanToVisibility}}">
                            <ProgressRing IsActive="True" Foreground="White" Width="15" Height="15"></ProgressRing>
                            <TextBlock Margin="10 0 0 0" Style="{StaticResource BodyTextBlockStyle}" FontSize="14"
                                   Text="{Binding [SubtitlesProcessMessage], Source={StaticResource Localized}}" HorizontalAlignment="Center" VerticalAlignment="Center"></TextBlock>
                        </StackPanel>
                        <StackPanel x:Name="NoSubsSettings" Orientation="Horizontal" Margin="0 5 0 0"  Grid.Row="1" Visibility="{Binding NoSubtitlesLanguageOnSettings, Converter={StaticResource BooleanToVisibility}}">
                            <Image Width="20" Margin="0" Height="20" Style="{StaticResource RedSadSmileImage}"></Image>
                            <TextBlock TextLineBounds="TrimToBaseline" Margin="10 0 0 0" MaxWidth="500" TextWrapping="Wrap" Style="{StaticResource BodyTextBlockStyle}" FontSize="14"
                                   Text="{Binding [NoSubsSettings], Source={StaticResource Localized}}" HorizontalAlignment="Center" VerticalAlignment="Center"></TextBlock>
                        </StackPanel>
                        <StackPanel x:Name="NoSubs" Orientation="Horizontal" Margin="0 5 0 0"  Grid.Row="1" Visibility="{Binding SubtitlesNotAvailable, Converter={StaticResource BooleanToVisibility}}">
                            <Image Width="20" Margin="0" Height="20" Style="{StaticResource RedSadSmileImage}"></Image>
                            <TextBlock Margin="10 0 0 0" Style="{StaticResource BodyTextBlockStyle}" FontSize="14"
                                   Text="{Binding [SubtitlesNotAvailable], Source={StaticResource Localized}}" HorizontalAlignment="Center" VerticalAlignment="Center"></TextBlock>
                        </StackPanel>
                        <Grid Grid.Row="2" Margin="0 20 0 0" VerticalAlignment="Top">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"></ColumnDefinition>
                                <ColumnDefinition Width="*"></ColumnDefinition>
                                <ColumnDefinition Width="*"></ColumnDefinition>
                            </Grid.ColumnDefinitions>
                            <!--<Grid Background="{StaticResource ShiftvDarkGreen}" Visibility="{Binding CanGoPrevious, Converter={StaticResource BooleanToVisibility}}" x:Name="PreviousButton"  Height="60" HorizontalAlignment="Left" VerticalAlignment="Center">
                                <interactivity:Interaction.Behaviors>
                                    <core:EventTriggerBehavior EventName="Tapped">
                                        <core:InvokeCommandAction Command="{Binding PreviousEpisodeClicked}"/>
                                    </core:EventTriggerBehavior>
                                </interactivity:Interaction.Behaviors>
                                <StackPanel Orientation="Horizontal" Margin="15">
                                    <Image Source="ms-appx:///Assets/previous11.png"></Image>
                                    <TextBlock FontWeight="Light" Margin="20 -5 0 0" FontSize="35" Foreground="White" Style="{StaticResource EpisodeTitle}" Text="{Binding [BtnPrev_Upper], Source={StaticResource Localized}}" HorizontalAlignment="Center" VerticalAlignment="Center"></TextBlock>
                                </StackPanel>

                            </Grid>-->
                            <Grid Grid.Column="2" Background="{StaticResource ShiftvDarkGreen}" Visibility="{Binding CanDownload, Converter={StaticResource BooleanToVisibility}}" x:Name="StreamsButton"  Height="60" HorizontalAlignment="Left" VerticalAlignment="Center">
                                <interactivity:Interaction.Behaviors>
                                    <core:EventTriggerBehavior EventName="Tapped">
                                        <core:InvokeCommandAction Command="{Binding StreamsClicked}"/>
                                    </core:EventTriggerBehavior>
                                </interactivity:Interaction.Behaviors>
                                <StackPanel Orientation="Horizontal" Margin="15">
                                    <Image Source="ms-appx:///Assets/listIcon.png"></Image>
                                    <TextBlock FontWeight="Light" Margin="10 -5 0 0" FontSize="35" Foreground="White" Style="{StaticResource EpisodeTitle}" Text="STREAM" HorizontalAlignment="Center" VerticalAlignment="Center"></TextBlock>
                                </StackPanel>

                            </Grid>
                            <!--<Grid Grid.Column="1" Background="{StaticResource ShiftvDarkGreen}"  Visibility="{Binding CanGoNext, Converter={StaticResource BooleanToVisibility}}" x:Name="NextButton"  Height="60" HorizontalAlignment="Left" VerticalAlignment="Center">
                                <interactivity:Interaction.Behaviors>
                                    <core:EventTriggerBehavior EventName="Tapped">
                                        <core:InvokeCommandAction Command="{Binding NextEpisodeClicked}"/>
                                    </core:EventTriggerBehavior>
                                </interactivity:Interaction.Behaviors>
                                <StackPanel Orientation="Horizontal" Margin="15">
                                    <TextBlock FontWeight="Light" Margin="0 -5 0 0" FontSize="35" Foreground="White" Style="{StaticResource EpisodeTitle}" Text="{Binding [BtnNext_Upper], Source={StaticResource Localized}}" HorizontalAlignment="Center" VerticalAlignment="Center"></TextBlock>
                                    <Image Source="ms-appx:///Assets/next15.png" Margin="20 0 0 0"></Image>
                                </StackPanel>

                            </Grid>-->

                        </Grid>
                    </Grid>
                    <ScrollViewer Width="500" Margin="80 0 40 80" Grid.Column="1" VerticalAlignment="Top" HorizontalScrollMode="Disabled" VerticalScrollBarVisibility="Auto" ZoomMode="Disabled" x:Name="Details">
                        <Grid Margin="0 0 0 0" >
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"></RowDefinition>
                                <RowDefinition  Height="Auto"></RowDefinition>
                                <RowDefinition  Height="Auto"></RowDefinition>
                                <RowDefinition  Height="Auto"></RowDefinition>
                                <RowDefinition  Height="Auto"></RowDefinition>
                                <RowDefinition  Height="Auto"></RowDefinition>
                            </Grid.RowDefinitions>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="auto"></ColumnDefinition>
                                <ColumnDefinition Width="80"></ColumnDefinition>
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Row="0" Grid.Column="1" Margin="10 0 0 0">
                                <FontIcon Style="{StaticResource WatchlistIcon}" Width="40" Height="40" Visibility="{Binding Movie.InWatchlist, Converter={StaticResource BooleanToVisibility}}" HorizontalAlignment="Left" VerticalAlignment="Center"></FontIcon>
                                <StackPanel Orientation="Horizontal">
                                    <FontIcon FontSize="24"
                                              Visibility="{Binding Movie.IsRated, Converter={StaticResource BooleanToVisibility}}"
                                              Glyph="&#xE0B4;" Foreground="{StaticResource ShiftvYellow}"
                                              Margin="8 0 0 0" />
                                    <TextBlock FontSize="25"
                                               Visibility="{Binding Movie.IsRated, Converter={StaticResource BooleanToVisibility}}"
                                               Style="{StaticResource SeriePageHeaders}"
                                               Text="{Binding Movie.RatedValue}" Margin="8 3 10 0" /></StackPanel>
                                <FontIcon Style="{StaticResource SeenIcon}" Width="40" Height="40" Visibility="{Binding Movie.Watched, Converter={StaticResource BooleanToVisibility}}" HorizontalAlignment="Left" VerticalAlignment="Center"></FontIcon>
                            </StackPanel>
                            <Image Grid.Row="0" Grid.Column="0" Width="400" Height="225" Source="{Binding Movie.Image.Fanart.Medium}" Stretch="UniformToFill" HorizontalAlignment="Left" VerticalAlignment="Top"/>
                            <TextBlock Margin="0 10 0 0" Grid.Column="0"  Grid.Row="1"  Width="400" Text="{Binding Movie.Sinopse}" Style="{StaticResource BodyTextBlockStyle}" TextWrapping="Wrap" HorizontalAlignment="Left" VerticalAlignment="Top"
                                       />
                            <StackPanel Grid.Column="0" Margin="0 10 0 0" Grid.Row="2" Orientation="Horizontal">
                                <!--<FontIcon FontSize="26" Style="{StaticResource LoveIcon}" Foreground="{StaticResource ShiftvLightRed}" Margin="0 0 10 0" HorizontalAlignment="Left" VerticalAlignment="Center"/>
                                <TextBlock FontSize="26"  Text="{Binding Movie.Loved}" Style="{StaticResource SeriePageHeaders}" HorizontalAlignment="Center" VerticalAlignment="Center"></TextBlock>
                                <FontIcon FontSize="26" Style="{StaticResource HateIcon}" Foreground="{StaticResource ShiftvDarkRed}" Margin="20 0 10 0" HorizontalAlignment="Left" VerticalAlignment="Center"/>
                                <TextBlock FontSize="26" Text="{Binding Movie.Hated}" Style="{StaticResource SeriePageHeaders}" HorizontalAlignment="Center" VerticalAlignment="Center"></TextBlock>
                                <FontIcon FontSize="26" Style="{StaticResource SeenIcon}" Foreground="{StaticResource ShiftvLightGreen}" Margin="20 0 10 0" HorizontalAlignment="Left" VerticalAlignment="Center"/>
                                <TextBlock FontSize="26" Text="{Binding Movie.Watchers}" Style="{StaticResource SeriePageHeaders}" HorizontalAlignment="Center" VerticalAlignment="Center"></TextBlock>-->
                                <FontIcon FontSize="32" FontFamily="Segoe UI Symbol" Glyph="&#xE0B4;" Foreground="{StaticResource ShiftvYellow}" Margin="0 0 10 0" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                <TextBlock Text="{Binding Movie.Rating}" Style="{StaticResource SeriePageHeaders}" HorizontalAlignment="Center" VerticalAlignment="Center"></TextBlock>
                                <TextBlock Text="{Binding Movie.Votes}" Style="{StaticResource SeriePageHeaders}" HorizontalAlignment="Center" VerticalAlignment="Bottom" Margin="5 0 10 3" FontSize="22"></TextBlock>
                            </StackPanel>


                            <StackPanel Grid.Column="0" Margin="0 10 0 0" Grid.Row="3" Orientation="Horizontal">
                                <TextBlock Style="{StaticResource ShowDescriptionSubtitles}" Margin="0,0,0,0"
                                    Text="{Binding [AirTime_Upper_DoubleDots], Source={StaticResource Localized}}" VerticalAlignment="Bottom" HorizontalAlignment="Left"/>
                                <TextBlock  Style="{StaticResource SubheaderTextBlockStyle}" Margin="10,0,0,0" Padding="0 0 0 5"
                                   Text="{Binding Movie.Released}" VerticalAlignment="Bottom" HorizontalAlignment="Left"/>
                            </StackPanel>
                            <StackPanel Grid.Column="0" Margin="0 5 0 0" Grid.Row="4" Orientation="Horizontal">
                                <TextBlock Style="{StaticResource ShowDescriptionSubtitles}" Margin="0,0,0,0"
                                    Text="{Binding [Runtime_Upper_DoubleDots], Source={StaticResource Localized}}"  VerticalAlignment="Bottom" HorizontalAlignment="Left"/>
                                <TextBlock  Style="{StaticResource SubheaderTextBlockStyle}" Margin="10,0,0,0" Padding="0 0 0 5"
                                   Text="{Binding Movie.Runtime}" VerticalAlignment="Bottom" HorizontalAlignment="Left"/>
                            </StackPanel>
                        </Grid>
                    </ScrollViewer>
                    <appBar:PubControl   Visibility="{Binding IsToShowAds, Converter={StaticResource BooleanToVisibility}}" x:Name="MyAdRotator" Grid.Column="2" Margin="20 20 40 0"  VerticalAlignment="Top"/>

                    <Grid Grid.Column="3" Margin="40 0 40 80" Width="500"  x:Name="Comments">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="180"></RowDefinition>
                            <RowDefinition Height="*"></RowDefinition>
                        </Grid.RowDefinitions>
                        <Grid Grid.Row="0" Margin="0 25 0 0" Visibility="{Binding IsUserLogged, Converter={StaticResource BooleanNotToVisibility}}" HorizontalAlignment="Center" VerticalAlignment="Top">
                            <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                                <Image Style="{StaticResource RedSadSmileImage}"></Image>
                                <TextBlock Style="{StaticResource ErrorMainMessage}"  Text="{Binding [CommentLoginErrorMainMessage], Source={StaticResource Localized}}"></TextBlock>
                                <TextBlock Style="{StaticResource ErrorSubMessage}"   Text="{Binding [CommentLoginErrorSubMessage_Bracket], Source={StaticResource Localized}}"></TextBlock>
                            </StackPanel>
                        </Grid>
                        <Grid Width="500" Grid.Row="0" Margin="0 0 0 0" Visibility="{Binding IsUserLogged, Converter={StaticResource BooleanToVisibility}}">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"></RowDefinition>
                                <RowDefinition Height="*"></RowDefinition>
                                <RowDefinition Height="Auto"></RowDefinition>
                            </Grid.RowDefinitions>
                            <Grid Grid.Column="0">
                                <StackPanel Orientation="Horizontal" VerticalAlignment="Bottom" HorizontalAlignment="Left" Margin="0,0,15,10">
                                    <Grid  Height="50" Width="50">
                                        <Image Visibility="{Binding CurrentUserAccount.User.IsGold, Converter={StaticResource BooleanToVisibility}}" Source="ms-appx:///Assets/goldUser.png" Width="15" VerticalAlignment="Top" Margin="0 0 0 0" HorizontalAlignment="Left"></Image>
                                        <Image Visibility="{Binding CurrentUserAccount.User.IsSilver, Converter={StaticResource BooleanToVisibility}}" Source="ms-appx:///Assets/silverUser.png" Width="15" VerticalAlignment="Top" Margin="0 0 0 0" HorizontalAlignment="Left"></Image>

                                        <Ellipse Height="40" Width="40" VerticalAlignment="Center" HorizontalAlignment="Center">
                                            <Ellipse.Fill>
                                                <ImageBrush ImageSource="{Binding CurrentUserAccount.Avatar}"
                                                                                    AlignmentX="Center"
                                                                                    AlignmentY="Center" />
                                            </Ellipse.Fill>
                                        </Ellipse>
                                    
                                    </Grid>
                                    <StackPanel Orientation="Vertical">
                                        <TextBlock Text="{Binding CurrentUserAccount.Username}"  Margin="20 0 0 0"  Style="{StaticResource UsernameTextBlock}"   VerticalAlignment="Center"></TextBlock>

                                    </StackPanel>
                                    <ProgressRing  Margin="20 0 0 0" IsActive="{Binding IsTryingToComment}" Visibility="{Binding IsTryingToComment, Converter={StaticResource BooleanToVisibility}}" Foreground="White" Width="25" Height="25" VerticalAlignment="Center"></ProgressRing>

                                </StackPanel>
                            </Grid>
                            <StackPanel Height="80"  Grid.Row="1" Orientation="Vertical">
                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                                    <TextBlock Foreground="{Binding NumLettersColorBrush}" Text="{Binding NumLetters}" x:Name="TotalWords" FontSize="16"  Style="{StaticResource BodyTextBlockStyle}"></TextBlock>
                                    <TextBlock Foreground="{Binding NumLettersColorBrush}" Margin="7 0 0 0" Text="words" x:Name="TotalWordsText"  FontSize="16" Style="{StaticResource BodyTextBlockStyle}"></TextBlock>
                                </StackPanel>
                                <TextBox x:Name="CommentTextBox"  Height="60"  IsEnabled="{Binding IsTryingToComment,Converter={StaticResource NegateBoolean}}" TextWrapping="Wrap" IsSpellCheckEnabled="True" AcceptsReturn="True"  Text="{Binding NewComment, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                                </TextBox>
                            </StackPanel>
                            <Grid Grid.Row="2">
                                <StackPanel Orientation="Horizontal">
                                    <CheckBox IsEnabled="{Binding IsTryingToComment,Converter={StaticResource NegateBoolean}}" IsChecked="{Binding IsSpoiler, Mode=TwoWay}" Content="{Binding [ContainsSpoil], Source={StaticResource Localized}}"></CheckBox>
                                    <CheckBox IsEnabled="{Binding IsTryingToComment,Converter={StaticResource NegateBoolean}}" Margin="20 0 0 0" IsChecked="{Binding IsReview, Mode=TwoWay}"  Content="{Binding [IsReview], Source={StaticResource Localized}}"></CheckBox>
                                </StackPanel>
                                <Button IsEnabled="{Binding IsCommentButtonEnabled}"  Content="{Binding [AddComment], Source={StaticResource Localized}}" Command="{Binding AddComment}" HorizontalAlignment="Right" VerticalAlignment="Stretch"></Button>
                            </Grid>
                        </Grid>
                        <Grid Grid.Row="1" Margin="0 20 0 0" Visibility="{Binding NoCommentsAvailable, Converter={StaticResource BooleanToVisibility}}" HorizontalAlignment="Center" VerticalAlignment="Top">
                            <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                                <Image Style="{StaticResource RedSadSmileImage}"></Image>
                                <TextBlock Style="{StaticResource ErrorMainMessage}" Text="{Binding [NoCommentsErrorMainMessage], Source={StaticResource Localized}}"></TextBlock>
                                <TextBlock Style="{StaticResource ErrorSubMessage}" Text="{Binding [NoCommentsErrorSubMessage_Bracket], Source={StaticResource Localized}}" ></TextBlock>
                            </StackPanel>
                        </Grid>
                        <ProgressRing Margin="0 20 0 0" Grid.Row="1" IsActive="{Binding IsLoadingComments}" Visibility="{Binding IsLoadingComments, Converter={StaticResource BooleanToVisibility}}" Foreground="White" Width="40" Height="40" VerticalAlignment="Top"></ProgressRing>
                        <ListView  Margin="0 20 0 0"  Grid.Row="1"  SelectionMode="None" ItemContainerStyle="{StaticResource EpisodeListViewItemStyle}" ItemsSource="{Binding Comments}">
                            <ListView.ItemTemplate>
                                <DataTemplate>
                                    <Grid Width="500" Margin="0 10 0 20">
                                        <Grid.RowDefinitions>
                                            <RowDefinition ></RowDefinition>
                                            <RowDefinition ></RowDefinition>
                                        </Grid.RowDefinitions>
                                        <Grid Grid.Column="0">
                                            <StackPanel Orientation="Horizontal" VerticalAlignment="Bottom" HorizontalAlignment="Left" Margin="0,0,15,10" Tapped="UserTapped">
                                                <Grid  Height="70" Width="70">
                                                    <Image Visibility="{Binding User.IsGold,Converter={StaticResource BooleanToVisibility}}" Margin="0 0 0 0" Source="ms-appx:///Assets/goldUser.png" Width="20" VerticalAlignment="Top" HorizontalAlignment="Left"></Image>
                                                    <Image Visibility="{Binding User.IsSilver, Converter={StaticResource BooleanToVisibility}}" Margin="0 0 0 0" Source="ms-appx:///Assets/silverUser.png" Width="20" VerticalAlignment="Top" HorizontalAlignment="Left"></Image>

                                                    <Ellipse Height="60" Width="60" VerticalAlignment="Center" HorizontalAlignment="Center">
                                                        <Ellipse.Fill>
                                                            <ImageBrush ImageSource="{Binding User.Avatar}"
                                                                                    AlignmentX="Center"
                                                                                    AlignmentY="Center" />
                                                        </Ellipse.Fill>
                                                    </Ellipse>
                                               
                                                </Grid>
                                                <StackPanel Orientation="Vertical">
                                                    <TextBlock Text="{Binding User.Username}" Foreground="{StaticResource ShiftvDarkGreen}" Margin="20 0 0 0" FontSize="30" Style="{StaticResource SubheaderTextBlockStyle}"   VerticalAlignment="Center"></TextBlock>
                                                    <TextBlock Text="{Binding CommentDate}" Margin="19 3 0 0" FontSize="14" Style="{StaticResource BodyTextBlockStyle}"  VerticalAlignment="Center"></TextBlock>
                                                </StackPanel>
                                            </StackPanel>
                                        </Grid>
                                        <TextBlock Grid.Row="1" Margin="80 0 50 0" Text="{Binding Comment}" Style="{StaticResource BodyTextBlockStyle}" TextWrapping="Wrap"></TextBlock>
                                        <StackPanel   Grid.Row="1" MinHeight="50" Visibility="{Binding IsSpoiler, Converter={StaticResource BooleanToVisibility}}" Background="{StaticResource BackgroundColorNearBlack}" DoubleTapped="UIElement_OnDoubleTapped">
                                            <TextBlock Text="{Binding [SpoilerAlertMainMessage_Upper], Source={StaticResource Localized}}" Style="{StaticResource SpoilerAlert}" ></TextBlock>
                                            <TextBlock Style="{StaticResource SpoilerAlertSub}" Text="{Binding [SpoilerAlertSubMessage_Bracket], Source={StaticResource Localized}}" ></TextBlock>
                                        </StackPanel>
                                    </Grid>
                                </DataTemplate>
                            </ListView.ItemTemplate>
                        </ListView>
                    </Grid>
                </Grid>
            </ScrollViewer>
        </Grid>
     
        <handlers:InternetConnectionHandler x:Name="InternetConnectionError" VerticalAlignment="Top" HorizontalAlignment="Center">

        </handlers:InternetConnectionHandler>
        <Button x:Name="AppBarButton" Click="ClickOpenAppBar" Width="70" Height="45" Margin="10 0 100 -5" Padding="0 10 0 0" BorderBrush="Transparent" HorizontalAlignment="Right" VerticalAlignment="Bottom" Background="{StaticResource ShiftvDarkGreen}">
            <Image Source="ms-appx:///Assets/threedots.png" Width="40"></Image>
        </Button>
        <Border Visibility="{Binding IsStreamsVisible, Converter={StaticResource BooleanToVisibility}}" Tapped="TappedMainGrid" Background="Transparent" Opacity="0.3"/>
        <FlyoutPresenter Margin="670 0 0 0" Visibility="{Binding IsStreamsVisible, Converter={StaticResource BooleanToVisibility}}" Grid.Row="0" VerticalAlignment="Center"  HorizontalAlignment="Left" Style="{StaticResource FlyoutMenu}">
            <ListView RequestedTheme="Dark" SelectionMode="None" IsSwipeEnabled="False" Background="{StaticResource BackgroundColorAlmostBlack}"
                                  ItemsSource="{Binding AvailableStreams}">
                <ListView.ItemTemplate>
                    <DataTemplate>
                        <Grid Tapped="UIElement_OnTapped">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="80"></ColumnDefinition>
                                    <ColumnDefinition></ColumnDefinition>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="40"></RowDefinition>
                                    <RowDefinition  Height="40"></RowDefinition>
                                </Grid.RowDefinitions>
                                <Grid Grid.Column="0" Grid.Row="0" Grid.RowSpan="2" Background="{StaticResource ShiftvLightRed}" Visibility="{Binding IsPlayingNow, Converter={StaticResource BooleanNotToVisibility}}">
                                    <TextBlock  Style="{StaticResource SerieEpisodeTitle}" HorizontalAlignment="Center" FontSize="24" VerticalAlignment="Center" Text="{Binding Quality}" Margin="5"></TextBlock>
                                </Grid>
                                <Grid Grid.Column="0" Grid.Row="0" Grid.RowSpan="2" Background="{StaticResource ShiftvLightGreen}" Visibility="{Binding IsPlayingNow, Converter={StaticResource BooleanToVisibility}}">
                                    <TextBlock  Style="{StaticResource SerieEpisodeTitle}" HorizontalAlignment="Center" FontSize="24" VerticalAlignment="Center" Text="{Binding Quality}" Margin="5"></TextBlock>
                                </Grid>
                                <StackPanel Orientation="Vertical"  Grid.Row="1" Grid.Column="1" >
                                    <TextBlock FontWeight="Light" VerticalAlignment="Top" Margin="10 0 0 0" Text="speed / host" Foreground="White" FontSize="13"/>
                                    <TextBlock FontWeight="Bold"  VerticalAlignment="Top" Margin="10 -1 0 0" Text="{Binding Speed}" Foreground="White" FontSize="18"/>
                                </StackPanel>
                                <StackPanel Orientation="Vertical"  Grid.Row="0" Grid.Column="1" >
                                    <TextBlock FontWeight="Light" VerticalAlignment="Top" Margin="10 0 0 0" Text="size" Foreground="White" FontSize="13"/>
                                    <TextBlock FontWeight="Bold"  VerticalAlignment="Top" Margin="10 -1 0 0" Text="{Binding FileSize}" Foreground="White" FontSize="18"/>
                                </StackPanel>
                                <!--<StackPanel Orientation="Vertical"  Grid.Row="2" Grid.Column="1" >
                                    <TextBlock FontWeight="Normal" VerticalAlignment="Top" Margin="10 0 0 0" Text="host" Foreground="White" FontSize="12"/>
                                    <TextBlock FontWeight="Bold"  VerticalAlignment="Top" Margin="10 -2 0 0" Text="{Binding StreamName}" Foreground="White" FontSize="17"/>
                                </StackPanel>-->
                            </Grid>
                        </Grid>
                    </DataTemplate>
                </ListView.ItemTemplate>
            </ListView>
        </FlyoutPresenter>
        <Border Visibility="{Binding IsRatingVisible, Converter={StaticResource BooleanToVisibility}}" Tapped="TappedMainGrid" Background="{StaticResource BackgroundColorAlmostBlack}" Opacity="0.4"/>
        <Grid Background="{StaticResource BackgroundColorAlmostBlack}" Visibility="{Binding IsRatingVisible, Converter={StaticResource BooleanToVisibility}}" Grid.Row="0" VerticalAlignment="Center"  HorizontalAlignment="Center" >
            <Grid Margin="20">
                <Grid.RowDefinitions>
                    <RowDefinition></RowDefinition>
                    <RowDefinition></RowDefinition>
                </Grid.RowDefinitions>
                <controls:Rating FontSize="45"  Grid.Row="1" Margin="0 5" SelectionMode="Continuous" ValueChanged="Rating_OnValueChanged" Value="{Binding RatingValue}"  ItemCount="10" Background="Transparent" Foreground="Gold" HorizontalAlignment="Left" VerticalAlignment="Center" >

                </controls:Rating>
                <TextBlock Grid.Row="0" FontSize="20" Margin="0 0 0 0" Style="{StaticResource TitleTextBlockStyle}" Text="your rating" VerticalAlignment="Bottom"></TextBlock>

            </Grid>
        </Grid>
        <appBar:RemovePubControl Margin="0 0 0 0" VerticalAlignment="Center" HorizontalAlignment="Center"
                                      />
        <appBar:RateAndReviewControl2 Margin="0 0 0 0" VerticalAlignment="Center" HorizontalAlignment="Center"/>
        <appBar:SoundClouderPub Margin="0 0 0 0" VerticalAlignment="Center" HorizontalAlignment="Center"/>

    </Grid>
    <Page.TopAppBar >
        <AppBar x:Name="TopAppBarPlayer"  Opened="AppBarOpened">
            <Grid>
                <TextBlock Margin="25"  Text="{Binding Movie.Title}" Style="{StaticResource HeaderTextBlockStyle}" 
                        IsHitTestVisible="false" TextWrapping="NoWrap" VerticalAlignment="Center"/>
            </Grid>
        </AppBar>
    </Page.TopAppBar>
    <Page.BottomAppBar >
        <CommandBar IsOpen="{Binding IsAppBarOpen}" x:Name="BottomAppBar"  Background="{StaticResource BackgroundColorAppBar}" BorderBrush="{x:Null}">

            <AppBarButton Label="{Binding [ChangeStream], Source={StaticResource Localized}}"  Visibility="{Binding CanDownload, Converter={StaticResource BooleanToVisibility}}">
                <AppBarButton.Icon >
                    <FontIcon Style="{StaticResource ChangeStreamIcon}"/>
                </AppBarButton.Icon>
                <AppBarButton.Flyout>
                    <Flyout FlyoutPresenterStyle="{StaticResource FlyoutMenu}">
                        <ListView RequestedTheme="Dark" SelectionMode="None" IsSwipeEnabled="False" Background="{StaticResource BackgroundColorAlmostBlack}"
                                  ItemsSource="{Binding AvailableStreams}">
                            <ListView.ItemTemplate>
                                <DataTemplate>
                                    <Grid Tapped="UIElement_OnTapped">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="60"></ColumnDefinition>
                                                <ColumnDefinition></ColumnDefinition>
                                            </Grid.ColumnDefinitions>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="30"></RowDefinition>
                                                <RowDefinition Height="30"></RowDefinition>
                                            </Grid.RowDefinitions>
                                            <Grid Grid.Column="0" Grid.Row="0" Grid.RowSpan="2" Background="{StaticResource ShiftvLightRed}" Visibility="{Binding IsPlayingNow, Converter={StaticResource BooleanNotToVisibility}}">
                                                <TextBlock  Style="{StaticResource SerieEpisodeTitle}" FontSize="22" HorizontalAlignment="Center" VerticalAlignment="Center" Text="{Binding Quality}" Margin="5"></TextBlock>
                                            </Grid>
                                            <Grid Grid.Column="0" Grid.Row="0" Grid.RowSpan="2" Background="{StaticResource ShiftvLightGreen}" Visibility="{Binding IsPlayingNow, Converter={StaticResource BooleanToVisibility}}">
                                                <TextBlock  Style="{StaticResource SerieEpisodeTitle}" FontSize="22" HorizontalAlignment="Center" VerticalAlignment="Center" Text="{Binding Quality}" Margin="5"></TextBlock>
                                            </Grid>
                                            <TextBlock Grid.Row="0" Grid.Column="1" FontWeight="Medium" Margin="10 0 0 0" Text="{Binding FileSize}" Foreground="White" FontSize="22"/>
                                            <TextBlock Grid.Row="1" Grid.Column="1" FontWeight="Light" Margin="10 0 0 0" Text="{Binding StreamName}" Foreground="White" FontSize="16"/>
                                        </Grid>
                                    </Grid>
                                </DataTemplate>
                            </ListView.ItemTemplate>
                        </ListView>
                    </Flyout>
                </AppBarButton.Flyout>
            </AppBarButton>
            <CommandBar.SecondaryCommands>
                <AppBarButton Label="{Binding [CheckIn], Source={StaticResource Localized}}" IsEnabled="{Binding CanUseAppBarButtons}" Command="{Binding CheckIn}" Visibility="{Binding CanCheckIn, Converter={StaticResource BooleanToVisibility}}">
                    <AppBarButton.Icon >
                        <FontIcon  Style="{StaticResource CheckInIcon}"/>
                    </AppBarButton.Icon>
                </AppBarButton>
                <AppBarButton Label="{Binding [RateMovie], Source={StaticResource Localized}}" IsEnabled="{Binding CanUseAppBarButtons}" Command="{Binding OpenRating}" >
                    <AppBarButton.Icon >
                        <FontIcon FontFamily="Segoe UI Symbol" Glyph="&#xE0B4;"/>
                    </AppBarButton.Icon>
                </AppBarButton>
                <AppBarButton Label="{Binding [Seen], Source={StaticResource Localized}}" IsEnabled="{Binding CanUseAppBarButtons}" Command="{Binding SetAsSeen}" Visibility="{Binding Watched, Converter={StaticResource BooleanNotToVisibility}}">
                    <AppBarButton.Icon >
                        <FontIcon Style="{StaticResource SeenIcon}"/>
                    </AppBarButton.Icon>
                </AppBarButton>

                <AppBarButton Label="{Binding [NotSeen], Source={StaticResource Localized}}" IsEnabled="{Binding CanUseAppBarButtons}" Command="{Binding SetAsUnseen}" Visibility="{Binding Watched, Converter={StaticResource BooleanToVisibility}}">
                    <AppBarButton.Icon >
                        <FontIcon  Style="{StaticResource SeenIcon}" RenderTransformOrigin="0.5,0.55">
                            <FontIcon.RenderTransform>
                                <ScaleTransform ScaleY="-1" />
                            </FontIcon.RenderTransform>
                        </FontIcon>
                    </AppBarButton.Icon>
                </AppBarButton>

                <AppBarButton Command="{Binding AddToWatchList}" IsEnabled="{Binding CanUseAppBarButtons}" Label="{Binding [AddToWatchlist], Source={StaticResource Localized}}" Visibility="{Binding IsInWatchList, Converter={StaticResource BooleanNotToVisibility}}">
                    <AppBarButton.Icon  >
                        <FontIcon  Style="{StaticResource WatchlistIcon}"/>
                    </AppBarButton.Icon>
                </AppBarButton>

                <AppBarButton Command="{Binding RemoveFromWatchList}" IsEnabled="{Binding CanUseAppBarButtons}" Label="{Binding [RemoveFromWatchlist], Source={StaticResource Localized}}" Visibility="{Binding IsInWatchList, Converter={StaticResource BooleanToVisibility}}">
                    <AppBarButton.Icon >
                        <FontIcon Style="{StaticResource WatchlistIcon}" RenderTransformOrigin="0.5,0.5">
                            <FontIcon.RenderTransform>
                                <ScaleTransform ScaleX="-1" />
                            </FontIcon.RenderTransform>
                        </FontIcon>
                    </AppBarButton.Icon>
                </AppBarButton>
            </CommandBar.SecondaryCommands>
        </CommandBar>
    </Page.BottomAppBar>
</Page>